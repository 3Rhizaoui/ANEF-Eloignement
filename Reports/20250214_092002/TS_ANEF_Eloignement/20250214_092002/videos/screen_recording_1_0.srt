1
00:00:02,780 --> 00:00:05,032
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:05,056 --> 00:00:05,072
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:05,078 --> 00:00:05,092
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:05,098 --> 00:00:05,157
15. DriverName = get("WebUI").get("browserType")

5
00:00:05,163 --> 00:00:05,192
19. println("DriverName :" + DriverName)

6
00:00:05,200 --> 00:00:05,218
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:05,229 --> 00:00:05,247
27. if (Profiles == "Usager")

8
00:00:05,251 --> 00:00:05,265
31. if (Profiles == "Agent")

9
00:00:05,271 --> 00:00:05,280
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:05,284 --> 00:00:05,291
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:05,294 --> 00:00:15,232
1. openBrowser(URLPortailAgentPreProd)

12
00:00:15,236 --> 00:00:15,501
9. maximizeWindow()

13
00:00:15,504 --> 00:00:16,577
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:16,584 --> 00:00:17,454
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:17,458 --> 00:00:17,466
5. if (Profiles == "Usager")

16
00:00:17,470 --> 00:00:17,479
11. Identification : Portail Agent

17
00:00:17,486 --> 00:00:17,494
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:17,498 --> 00:00:17,504
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:17,509 --> 00:00:20,876
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:20,880 --> 00:00:23,574
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:23,579 --> 00:00:25,105
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:25,109 --> 00:00:30,222
15. delay(5)

23
00:00:30,228 --> 00:00:30,340
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:30,346 --> 00:00:31,366
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:31,371 --> 00:00:35,323
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:35,326 --> 00:00:35,416
9. Vérifier la position de la page d'accueil eloignement

27
00:00:35,421 --> 00:00:40,443
13. delay(5)

28
00:00:40,446 --> 00:00:41,747
19. Cliquer sur le bouton Recherche Globale

29
00:00:41,751 --> 00:00:41,756
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:41,763 --> 00:00:41,775
29. if (CreationOuRecherche == "Recherche")

31
00:00:41,782 --> 00:00:44,411
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:44,415 --> 00:00:45,675
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:45,680 --> 00:00:45,838
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:45,842 --> 00:00:47,203
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:47,209 --> 00:00:52,238
17. delay(5)

36
00:00:52,241 --> 00:00:52,335
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:52,342 --> 00:00:53,695
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:53,701 --> 00:00:55,988
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:55,992 --> 00:00:55,997
19. if (CreationOuRecherche == "Creation")

40
00:00:56,001 --> 00:00:56,008
23. println(NumeroEtranger)

41
00:00:56,013 --> 00:00:57,626
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:57,632 --> 00:00:59,391
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:59,395 --> 00:01:04,422
5. delay(5)

44
00:01:04,427 --> 00:01:04,436
9. switch (Mesure)

45
00:01:04,441 --> 00:01:04,531
4.  Prendre Une Mesure Expulsion  

46
00:01:04,536 --> 00:01:05,946
8. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/select_Type_Mesure"), "Expulsion", false, STOP_ON_FAILURE)

47
00:01:05,954 --> 00:01:07,364
14. Cliquer sur le bourron Confirmer Mesure

48
00:01:07,372 --> 00:01:09,233
18. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

49
00:01:09,238 --> 00:01:09,243
22. break

50
00:01:09,248 --> 00:01:12,119
13. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

51
00:01:12,123 --> 00:01:12,163
3. Generer la date du jour

52
00:01:12,166 --> 00:01:12,214
7. currentDate = calendar.getTime()

53
00:01:12,219 --> 00:01:12,329
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

54
00:01:12,334 --> 00:01:12,339
15. formattedDate = sdf.format(currentDate)

55
00:01:12,345 --> 00:01:12,351
19. DateActuelle = formattedDate.toString()

56
00:01:12,357 --> 00:01:12,363
23. println(DateActuelle)

57
00:01:12,368 --> 00:01:12,373
27. if (Mesure != "ITF")

58
00:01:12,379 --> 00:01:13,777
3. Remplir le champ Fondement Legal

59
00:01:13,784 --> 00:01:13,791
7. if (Mesure == "Expulsion")

60
00:01:13,800 --> 00:01:13,805
1. if (NatureDeLacteExpulsion == "AME")

61
00:01:13,810 --> 00:01:15,247
3. Choisir une Nature de l'Acte AME 

62
00:01:15,255 --> 00:01:15,441
9. Vérifier l'autorité Decisionnaire : Ministre de l’Intérieur 

63
00:01:15,445 --> 00:01:15,592
13. verifyElementText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/p_Autorité_Decisionnaire"), "Ministre de l’Intérieur", STOP_ON_FAILURE)

64
00:01:15,597 --> 00:01:15,606
5. if (NatureDeLacteExpulsion == "APE")

65
00:01:15,612 --> 00:01:15,617
9. if (UrgenceAbsolueExpulsion == "Non")

66
00:01:15,622 --> 00:01:16,955
3. Choisir une Urgence Absolue == Non 

67
00:01:16,961 --> 00:01:20,740
9. Renseigner les champs Obligatoire Comex

68
00:01:20,743 --> 00:01:23,239
13. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/input_Date_Comex"), "22/06/2024", STOP_ON_FAILURE)

69
00:01:23,246 --> 00:01:24,550
17. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/btn_radio_Avis_Comex_Favorable"), STOP_ON_FAILURE)

70
00:01:24,557 --> 00:01:27,059
21. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/input_Date_Avis_Comex"), "22/06/2024", STOP_ON_FAILURE)

71
00:01:27,063 --> 00:01:28,374
27. Refuser de Poursuivre la procédure d'expulsion

72
00:01:28,382 --> 00:01:33,402
31. delay(5)

73
00:01:33,405 --> 00:01:33,524
37. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont desactivés 

74
00:01:33,529 --> 00:01:33,622
41. verifyElementNotClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Auteur_Decision"))

75
00:01:33,628 --> 00:01:33,707
45. verifyElementNotClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Ajouter_Mesure_Execution"))

76
00:01:33,713 --> 00:01:35,030
51. Accepter de Poursuivre la procédure d'expulsion

77
00:01:35,037 --> 00:01:40,063
55. delay(5)

78
00:01:40,068 --> 00:01:40,146
61. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont activés 

79
00:01:40,151 --> 00:01:40,274
65. verifyElementClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Pays_De_Renvoi"))

80
00:01:40,279 --> 00:01:40,354
69. verifyElementClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Auteur_Decision"))

81
00:01:40,359 --> 00:01:40,368
13. if (UrgenceAbsolueExpulsion == "Oui")

82
00:01:40,373 --> 00:01:40,580
13. Generer un numero aleatoire

83
00:01:40,586 --> 00:01:40,596
17. println(NumberUsagerRandom)

84
00:01:40,603 --> 00:01:40,615
21. RandomNumber = NumberUsagerRandom.toString()

85
00:01:40,620 --> 00:01:40,623
27. Renseigner les champs de l'accordeon Fondement Legal pour un OQTF 

86
00:01:40,628 --> 00:01:40,634
33. Renseigner les champs de l'accordeon Fondement Legal pour une Remise Schengen 

87
00:01:40,641 --> 00:01:40,650
39. generer un nombre aleatoire entre '1' et '30'

88
00:01:40,659 --> 00:01:40,667
43. println(RandomNumber)

89
00:01:40,677 --> 00:01:40,685
47. RandomNumberSelect = RandomNumber.toString()

90
00:01:40,694 --> 00:01:40,699
53. Renseigner les champs de l'accordeon Fondement Legal pour un Transfert Dublin 

91
00:01:40,705 --> 00:01:40,709
57. if (Mesure == "ExecutionFicheSIS")

92
00:01:40,715 --> 00:01:40,721
61. if (Mesure == "IAT")

93
00:01:40,726 --> 00:01:40,735
31. if (Mesure == "ITF")

94
00:01:40,742 --> 00:01:42,048
37. Enregistrer les modifications

95
00:01:42,057 --> 00:01:42,921
33. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Ajouter_Decision"), ["ModeNotification":ModeNotification], STOP_ON_FAILURE)

96
00:01:42,932 --> 00:01:42,938
1. calendar = Calendar.getInstance()

97
00:01:42,945 --> 00:01:42,949
5. currentDate = calendar.getTime()

98
00:01:42,955 --> 00:01:42,961
9. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

99
00:01:42,966 --> 00:01:42,970
13. formattedDate = sdf.format(currentDate)

100
00:01:42,978 --> 00:01:42,986
17. DateActuelle = formattedDate.toString()

101
00:01:42,995 --> 00:01:43,001
21. println(DateActuelle)

102
00:01:43,007 --> 00:01:43,489
27. Attendre que le bouton soit cliquable

103
00:01:43,494 --> 00:01:44,863
33. Cliquer sur le bouton Ajouter Une Decision 

104
00:01:44,872 --> 00:01:45,051
39. Confirmer l'Ajout de decision

105
00:01:45,055 --> 00:01:46,500
43. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/btn_Confirmer_Ajout_Decision"), STOP_ON_FAILURE)

106
00:01:46,509 --> 00:01:47,205
49. Attendre que le bouton Confirmer Notification soit cliquable

107
00:01:47,213 --> 00:01:48,666
55. Confirmer Notification

108
00:01:48,672 --> 00:01:50,106
59. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/select_Mode_Notification"), ModeNotification, false, STOP_ON_FAILURE)

109
00:01:50,116 --> 00:01:52,748
63. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/input_Date_Notification"), DateActuelle, STOP_ON_FAILURE)

110
00:01:52,758 --> 00:01:52,768
67. if (ModeNotification == "Voie administrative")

111
00:01:52,777 --> 00:01:55,226
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/input_Heure_Notification"), "14:30", STOP_ON_FAILURE)

112
00:01:55,233 --> 00:01:56,392
73. Ajouter un fichier 

113
00:01:56,398 --> 00:01:56,485
79. Confirmer l'ajout de Notification

114
00:01:56,489 --> 00:01:57,827
83. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/btn_Confirmer_Ajout_Notification"), STOP_ON_FAILURE)

115
00:01:57,833 --> 00:01:57,988
87. waitForElementClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/btn_Enregistrer"), 7, STOP_ON_FAILURE)

