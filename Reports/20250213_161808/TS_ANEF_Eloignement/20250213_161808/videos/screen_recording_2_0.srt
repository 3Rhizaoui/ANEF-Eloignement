1
00:00:00,003 --> 00:00:00,137
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:00,145 --> 00:00:00,147
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:00,150 --> 00:00:00,153
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:00,155 --> 00:00:00,159
15. DriverName = get("WebUI").get("browserType")

5
00:00:00,163 --> 00:00:00,165
19. println("DriverName :" + DriverName)

6
00:00:00,167 --> 00:00:00,170
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:00,173 --> 00:00:00,176
27. if (Profiles == "Usager")

8
00:00:00,181 --> 00:00:00,182
31. if (Profiles == "Agent")

9
00:00:00,184 --> 00:00:00,187
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:00,188 --> 00:00:00,191
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:00,194 --> 00:00:05,510
1. openBrowser(URLPortailAgentPreProd)

12
00:00:05,512 --> 00:00:05,618
9. maximizeWindow()

13
00:00:05,620 --> 00:00:05,803
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:05,806 --> 00:00:05,817
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:05,821 --> 00:00:05,824
5. if (Profiles == "Usager")

16
00:00:05,826 --> 00:00:05,828
11. Identification : Portail Agent

17
00:00:05,832 --> 00:00:05,834
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:05,840 --> 00:00:05,842
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:05,846 --> 00:00:08,289
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:08,292 --> 00:00:10,534
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:10,536 --> 00:00:11,716
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:11,720 --> 00:00:16,742
15. delay(5)

23
00:00:16,744 --> 00:00:16,784
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:16,787 --> 00:00:16,892
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:16,895 --> 00:00:19,774
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:19,776 --> 00:00:19,823
9. Vérifier la position de la page d'accueil eloignement

27
00:00:19,825 --> 00:00:24,832
13. delay(5)

28
00:00:24,834 --> 00:00:26,020
19. Cliquer sur le bouton Recherche Globale

29
00:00:26,023 --> 00:00:26,026
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:26,028 --> 00:00:26,029
29. if (CreationOuRecherche == "Recherche")

31
00:00:26,031 --> 00:00:28,316
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:28,318 --> 00:00:29,467
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:29,473 --> 00:00:29,526
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:29,530 --> 00:00:30,656
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:30,659 --> 00:00:35,680
17. delay(5)

36
00:00:35,682 --> 00:00:35,743
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:35,746 --> 00:00:36,882
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:36,888 --> 00:00:38,366
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:38,369 --> 00:00:38,371
19. if (CreationOuRecherche == "Creation")

40
00:00:38,373 --> 00:00:38,375
23. println(NumeroEtranger)

41
00:00:38,378 --> 00:00:38,501
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:38,504 --> 00:00:39,898
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:39,903 --> 00:00:39,910
5. switch (Mesure)

44
00:00:39,913 --> 00:00:39,982
4.  Prendre Une Mesure Expulsion  

45
00:00:39,984 --> 00:00:41,177
8. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/select_Type_Mesure"), "Expulsion", false, STOP_ON_FAILURE)

46
00:00:41,180 --> 00:00:42,308
14. Cliquer sur le bourron Confirmer Mesure

47
00:00:42,310 --> 00:00:42,984
18. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

48
00:00:42,987 --> 00:00:42,989
22. break

49
00:00:42,993 --> 00:00:43,187
9. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

50
00:00:43,189 --> 00:00:43,197
3. Generer la date du jour

51
00:00:43,200 --> 00:00:43,201
7. currentDate = calendar.getTime()

52
00:00:43,203 --> 00:00:43,204
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

53
00:00:43,206 --> 00:00:43,210
15. formattedDate = sdf.format(currentDate)

54
00:00:43,214 --> 00:00:43,216
19. DateActuelle = formattedDate.toString()

55
00:00:43,219 --> 00:00:43,223
23. println(DateActuelle)

56
00:00:43,228 --> 00:00:43,231
27. if (Mesure != "ITF")

57
00:00:43,233 --> 00:00:44,401
3. Remplir le champ Fondement Legal

58
00:00:44,404 --> 00:00:44,405
7. if (Mesure == "Expulsion")

59
00:00:44,407 --> 00:00:44,409
1. if (NatureDeLacteExpulsion == "AME")

60
00:00:44,412 --> 00:00:44,414
5. if (NatureDeLacteExpulsion == "APE")

61
00:00:44,415 --> 00:00:44,417
9. if (UrgenceAbsolueExpulsion == "Non")

62
00:00:44,418 --> 00:00:44,420
13. if (UrgenceAbsolueExpulsion == "Oui")

63
00:00:44,421 --> 00:00:45,626
3. Choisir une Urgence Absolue == Oui 

64
00:00:45,628 --> 00:00:50,635
7. delay(5)

65
00:00:50,637 --> 00:00:50,682
13. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont activés 

66
00:00:50,683 --> 00:00:50,727
17. verifyElementClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Auteur_Decision"))

67
00:00:50,728 --> 00:00:50,729
13. Generer un numero aleatoire

68
00:00:50,732 --> 00:00:50,733
17. println(NumberUsagerRandom)

69
00:00:50,735 --> 00:00:50,735
21. RandomNumber = NumberUsagerRandom.toString()

70
00:00:50,737 --> 00:00:50,738
27. Renseigner les champs de l'accordeon Fondement Legal pour un OQTF 

71
00:00:50,741 --> 00:00:50,742
33. Renseigner les champs de l'accordeon Fondement Legal pour une Remise Schengen 

72
00:00:50,744 --> 00:00:50,745
39. generer un nombre aleatoire entre '1' et '30'

73
00:00:50,746 --> 00:00:50,747
43. println(RandomNumber)

74
00:00:50,748 --> 00:00:50,749
47. RandomNumberSelect = RandomNumber.toString()

75
00:00:50,750 --> 00:00:50,751
53. Renseigner les champs de l'accordeon Fondement Legal pour un Transfert Dublin 

76
00:00:50,752 --> 00:00:50,753
57. if (Mesure == "ExecutionFicheSIS")

77
00:00:50,755 --> 00:00:50,756
61. if (Mesure == "IAT")

78
00:00:50,758 --> 00:00:50,759
31. if (Mesure == "ITF")

79
00:00:50,760 --> 00:00:51,905
37. Enregistrer les modifications

80
00:00:51,908 --> 00:00:51,996
33. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Ajouter_Decision"), ["ModeNotification":ModeNotification], STOP_ON_FAILURE)

81
00:00:52,007 --> 00:00:52,008
1. calendar = Calendar.getInstance()

82
00:00:52,010 --> 00:00:52,011
5. currentDate = calendar.getTime()

83
00:00:52,013 --> 00:00:52,014
9. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

84
00:00:52,016 --> 00:00:52,016
13. formattedDate = sdf.format(currentDate)

85
00:00:52,019 --> 00:00:52,022
17. DateActuelle = formattedDate.toString()

86
00:00:52,025 --> 00:00:52,027
21. println(DateActuelle)

87
00:00:52,029 --> 00:00:52,090
27. Attendre que le bouton soit cliquable

88
00:00:52,092 --> 00:00:53,569
33. Cliquer sur le bouton Ajouter Une Decision 

89
00:00:53,571 --> 00:00:53,649
39. Confirmer l'Ajout de decision

90
00:00:53,651 --> 00:00:54,893
43. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/btn_Confirmer_Ajout_Decision"), STOP_ON_FAILURE)

91
00:00:54,896 --> 00:00:56,049
49. Attendre que le bouton Confirmer Notification soit cliquable

92
00:00:56,051 --> 00:00:57,203
55. Confirmer Notification

93
00:00:57,206 --> 00:00:58,436
59. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/select_Mode_Notification"), ModeNotification, false, STOP_ON_FAILURE)

94
00:00:58,438 --> 00:01:00,684
63. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/input_Date_Notification"), DateActuelle, STOP_ON_FAILURE)

95
00:01:00,687 --> 00:01:00,688
67. if (ModeNotification == "Voie administrative")

96
00:01:00,691 --> 00:01:02,935
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/input_Heure_Notification"), "14:30", STOP_ON_FAILURE)

97
00:01:02,938 --> 00:01:04,025
73. Ajouter un fichier 

98
00:01:04,028 --> 00:01:04,081
79. Confirmer l'ajout de Notification

99
00:01:04,083 --> 00:01:05,263
83. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/btn_Confirmer_Ajout_Notification"), STOP_ON_FAILURE)

100
00:01:05,266 --> 00:01:05,376
87. waitForElementClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Ajouter_Decision/btn_Enregistrer"), 7, STOP_ON_FAILURE)

