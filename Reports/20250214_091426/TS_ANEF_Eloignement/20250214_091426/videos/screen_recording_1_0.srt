1
00:00:01,425 --> 00:00:02,759
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:02,779 --> 00:00:02,787
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:02,790 --> 00:00:02,797
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:02,800 --> 00:00:02,830
15. DriverName = get("WebUI").get("browserType")

5
00:00:02,832 --> 00:00:02,850
19. println("DriverName :" + DriverName)

6
00:00:02,853 --> 00:00:02,861
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:02,865 --> 00:00:02,871
27. if (Profiles == "Usager")

8
00:00:02,874 --> 00:00:02,878
31. if (Profiles == "Agent")

9
00:00:02,881 --> 00:00:02,886
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:02,894 --> 00:00:02,900
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:02,903 --> 00:00:09,696
1. openBrowser(URLPortailAgentPreProd)

12
00:00:09,698 --> 00:00:09,867
9. maximizeWindow()

13
00:00:09,870 --> 00:00:10,604
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:10,606 --> 00:00:10,965
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:10,968 --> 00:00:10,971
5. if (Profiles == "Usager")

16
00:00:10,974 --> 00:00:10,980
11. Identification : Portail Agent

17
00:00:10,982 --> 00:00:10,987
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:10,989 --> 00:00:10,993
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:10,997 --> 00:00:13,733
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:13,737 --> 00:00:16,062
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:16,066 --> 00:00:17,458
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:17,461 --> 00:00:22,522
15. delay(5)

23
00:00:22,527 --> 00:00:22,626
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:22,628 --> 00:00:23,318
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:23,322 --> 00:00:26,900
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:26,904 --> 00:00:26,963
9. Vérifier la position de la page d'accueil eloignement

27
00:00:26,967 --> 00:00:31,988
13. delay(5)

28
00:00:31,992 --> 00:00:33,236
19. Cliquer sur le bouton Recherche Globale

29
00:00:33,239 --> 00:00:33,244
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:33,250 --> 00:00:33,255
29. if (CreationOuRecherche == "Recherche")

31
00:00:33,258 --> 00:00:35,713
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:35,716 --> 00:00:36,932
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:36,935 --> 00:00:37,046
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:37,049 --> 00:00:38,272
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:38,277 --> 00:00:43,305
17. delay(5)

36
00:00:43,308 --> 00:00:43,374
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:43,377 --> 00:00:44,594
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:44,601 --> 00:00:46,109
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:46,111 --> 00:00:46,114
19. if (CreationOuRecherche == "Creation")

40
00:00:46,116 --> 00:00:46,118
23. println(NumeroEtranger)

41
00:00:46,124 --> 00:00:47,203
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:47,206 --> 00:00:48,580
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:48,587 --> 00:00:53,615
5. delay(5)

44
00:00:53,620 --> 00:00:53,628
9. switch (Mesure)

45
00:00:53,633 --> 00:00:53,713
4.  Prendre Une Mesure Expulsion  

46
00:00:53,717 --> 00:00:54,980
8. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/select_Type_Mesure"), "Expulsion", false, STOP_ON_FAILURE)

47
00:00:54,983 --> 00:00:56,201
14. Cliquer sur le bourron Confirmer Mesure

48
00:00:56,204 --> 00:00:56,836
18. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

49
00:00:56,841 --> 00:00:56,850
22. break

50
00:00:56,854 --> 00:00:59,245
13. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

51
00:00:59,249 --> 00:00:59,280
3. Generer la date du jour

52
00:00:59,286 --> 00:00:59,315
7. currentDate = calendar.getTime()

53
00:00:59,321 --> 00:00:59,376
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

54
00:00:59,380 --> 00:00:59,386
15. formattedDate = sdf.format(currentDate)

55
00:00:59,391 --> 00:00:59,396
19. DateActuelle = formattedDate.toString()

56
00:00:59,403 --> 00:00:59,411
23. println(DateActuelle)

57
00:00:59,416 --> 00:00:59,424
27. if (Mesure != "ITF")

58
00:00:59,428 --> 00:01:00,685
3. Remplir le champ Fondement Legal

59
00:01:00,687 --> 00:01:00,689
7. if (Mesure == "Expulsion")

60
00:01:00,693 --> 00:01:00,697
1. if (NatureDeLacteExpulsion == "AME")

61
00:01:00,700 --> 00:01:01,917
3. Choisir une Nature de l'Acte AME 

62
00:01:01,921 --> 00:01:02,021
9. Vérifier l'autorité Decisionnaire : Ministre de l’Intérieur 

63
00:01:02,024 --> 00:01:05,370
13. verifyElementText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/p_Autorité_Decisionnaire"), "Ministre de l’Intérieur", STOP_ON_FAILURE)

