1
00:00:00,956 --> 00:00:01,941
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:01,954 --> 00:00:01,959
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:01,960 --> 00:00:01,965
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:01,968 --> 00:00:02,000
15. DriverName = get("WebUI").get("browserType")

5
00:00:02,002 --> 00:00:02,016
19. println("DriverName :" + DriverName)

6
00:00:02,018 --> 00:00:02,024
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:02,029 --> 00:00:02,032
27. if (Profiles == "Usager")

8
00:00:02,034 --> 00:00:02,038
31. if (Profiles == "Agent")

9
00:00:02,040 --> 00:00:02,043
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:02,045 --> 00:00:09,649
1. openBrowser(URLPortailAgentQualif)

11
00:00:09,652 --> 00:00:09,660
5. if (EnvExec == "URLPortailAgentPreProd")

12
00:00:09,662 --> 00:00:09,843
9. maximizeWindow()

13
00:00:09,845 --> 00:00:10,690
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:10,694 --> 00:00:11,106
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:11,108 --> 00:00:11,113
5. if (Profiles == "Usager")

16
00:00:11,116 --> 00:00:11,120
11. Identification : Portail Agent

17
00:00:11,122 --> 00:00:11,124
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:11,127 --> 00:00:13,696
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

19
00:00:13,700 --> 00:00:15,999
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

20
00:00:16,002 --> 00:00:16,007
5. if (EnvExec == "URLPortailAgentPreProd")

21
00:00:16,009 --> 00:00:17,536
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:17,539 --> 00:00:22,601
15. delay(5)

23
00:00:22,604 --> 00:00:22,671
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:22,673 --> 00:00:23,089
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:23,090 --> 00:00:26,159
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:26,162 --> 00:00:26,202
9. Vérifier la position de la page d'accueil eloignement

27
00:00:26,204 --> 00:00:31,216
13. delay(5)

28
00:00:31,220 --> 00:00:32,378
19. Cliquer sur le bouton Recherche Globale

29
00:00:32,380 --> 00:00:32,383
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:32,385 --> 00:00:32,388
29. if (CreationOuRecherche == "Recherche")

31
00:00:32,389 --> 00:00:34,688
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:34,692 --> 00:00:35,829
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:35,831 --> 00:00:35,894
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:35,897 --> 00:00:37,035
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:37,038 --> 00:00:42,047
17. delay(5)

36
00:00:42,049 --> 00:00:42,093
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:42,095 --> 00:00:43,235
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:43,239 --> 00:00:44,702
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:44,704 --> 00:00:44,707
19. if (CreationOuRecherche == "Creation")

40
00:00:44,709 --> 00:00:44,712
23. println(NumeroEtranger)

41
00:00:44,714 --> 00:00:45,491
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:45,493 --> 00:00:46,712
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:46,714 --> 00:00:46,721
5. switch (Mesure)

44
00:00:46,727 --> 00:00:47,939
4.  Prendre Une Mesure OQTF  

45
00:00:47,942 --> 00:00:49,082
10. Cliquer sur le bourron Confirmer Mesure

46
00:00:49,084 --> 00:00:49,684
14. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

47
00:00:49,686 --> 00:00:49,687
18. break

48
00:00:49,689 --> 00:00:51,078
9. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

49
00:00:51,082 --> 00:00:51,094
3. Generer la date du jour

50
00:00:51,096 --> 00:00:51,113
7. currentDate = calendar.getTime()

51
00:00:51,116 --> 00:00:51,151
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

52
00:00:51,153 --> 00:00:51,156
15. formattedDate = sdf.format(currentDate)

53
00:00:51,160 --> 00:00:51,164
19. DateActuelle = formattedDate.toString()

54
00:00:51,167 --> 00:00:51,171
23. println(DateActuelle)

55
00:00:51,175 --> 00:00:51,178
27. if (Mesure != "ITF")

56
00:00:51,180 --> 00:00:52,375
3. Remplir le champ Fondement Legal

57
00:00:52,378 --> 00:00:52,381
7. if (Mesure == "Expulsion")

58
00:00:52,386 --> 00:00:52,475
13. Generer un numero aleatoire

59
00:00:52,478 --> 00:00:52,485
17. println(NumberUsagerRandom)

60
00:00:52,487 --> 00:00:52,494
21. RandomNumber = NumberUsagerRandom.toString()

61
00:00:52,498 --> 00:00:52,500
27. Renseigner les champs de l'accordeon Fondement Legal pour un OQTF 

62
00:00:52,502 --> 00:00:52,504
1. if (RefuserDepartVolontaireOQTF == "false")

63
00:00:52,507 --> 00:00:52,511
5. if (RefuserDepartVolontaireOQTF == "true")

64
00:00:52,512 --> 00:00:53,647
3. Refuser le delai depart Volontaire

65
00:00:53,649 --> 00:01:03,674
7. delay(10)

66
00:01:03,677 --> 00:01:03,731
13. Verifier que les champs DDV sont désactivés  

67
00:01:03,733 --> 00:01:03,799
17. verifyElementText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/p_Expiration_Delai"), "-", STOP_ON_FAILURE)

68
00:01:03,801 --> 00:01:05,778
23. renseigner IRTF= 'L. 612-6' 

