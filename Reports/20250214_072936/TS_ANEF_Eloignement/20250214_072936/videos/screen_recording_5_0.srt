1
00:00:00,003 --> 00:00:00,106
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:00,111 --> 00:00:00,113
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:00,119 --> 00:00:00,120
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:00,122 --> 00:00:00,123
15. DriverName = get("WebUI").get("browserType")

5
00:00:00,125 --> 00:00:00,126
19. println("DriverName :" + DriverName)

6
00:00:00,127 --> 00:00:00,129
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:00,133 --> 00:00:00,134
27. if (Profiles == "Usager")

8
00:00:00,136 --> 00:00:00,137
31. if (Profiles == "Agent")

9
00:00:00,139 --> 00:00:00,140
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:00,141 --> 00:00:00,142
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:00,144 --> 00:00:06,259
1. openBrowser(URLPortailAgentPreProd)

12
00:00:06,261 --> 00:00:06,278
9. maximizeWindow()

13
00:00:06,281 --> 00:00:06,387
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:06,393 --> 00:00:06,404
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:06,406 --> 00:00:06,407
5. if (Profiles == "Usager")

16
00:00:06,409 --> 00:00:06,410
11. Identification : Portail Agent

17
00:00:06,412 --> 00:00:06,414
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:06,419 --> 00:00:06,420
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:06,422 --> 00:00:08,988
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:08,990 --> 00:00:11,773
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:11,775 --> 00:00:13,109
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:13,111 --> 00:00:18,121
15. delay(5)

23
00:00:18,123 --> 00:00:18,169
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:18,172 --> 00:00:18,281
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:18,283 --> 00:00:22,072
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:22,075 --> 00:00:22,165
9. Vérifier la position de la page d'accueil eloignement

27
00:00:22,167 --> 00:00:27,173
13. delay(5)

28
00:00:27,177 --> 00:00:28,527
19. Cliquer sur le bouton Recherche Globale

29
00:00:28,529 --> 00:00:28,530
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:28,532 --> 00:00:28,533
29. if (CreationOuRecherche == "Recherche")

31
00:00:28,536 --> 00:00:31,117
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:31,120 --> 00:00:32,335
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:32,338 --> 00:00:32,402
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:32,406 --> 00:00:33,601
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:33,604 --> 00:00:38,610
17. delay(5)

36
00:00:38,612 --> 00:00:38,653
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:38,655 --> 00:00:39,803
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:39,805 --> 00:00:41,318
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:41,321 --> 00:00:41,323
19. if (CreationOuRecherche == "Creation")

40
00:00:41,325 --> 00:00:41,327
23. println(NumeroEtranger)

41
00:00:41,330 --> 00:00:41,429
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:41,436 --> 00:00:43,219
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:43,221 --> 00:00:43,225
5. switch (Mesure)

44
00:00:43,228 --> 00:00:44,462
4.  Prendre Une Mesure RemiseSchengen  

45
00:00:44,464 --> 00:00:45,625
10. Cliquer sur le bourron Confirmer Mesure

46
00:00:45,627 --> 00:00:45,630
14. break

47
00:00:45,632 --> 00:00:47,144
9. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

48
00:00:47,147 --> 00:00:47,170
3. Generer la date du jour

49
00:00:47,175 --> 00:00:47,198
7. currentDate = calendar.getTime()

50
00:00:47,201 --> 00:00:47,244
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

51
00:00:47,247 --> 00:00:47,251
15. formattedDate = sdf.format(currentDate)

52
00:00:47,254 --> 00:00:47,257
19. DateActuelle = formattedDate.toString()

53
00:00:47,259 --> 00:00:47,263
23. println(DateActuelle)

54
00:00:47,267 --> 00:00:47,270
27. if (Mesure != "ITF")

55
00:00:47,273 --> 00:00:57,264
3. Remplir le champ Fondement Legal

56
00:00:57,268 --> 00:00:57,269
7. if (Mesure == "Expulsion")

57
00:00:57,273 --> 00:00:57,382
13. Generer un numero aleatoire

58
00:00:57,385 --> 00:00:57,392
17. println(NumberUsagerRandom)

59
00:00:57,395 --> 00:00:57,404
21. RandomNumber = NumberUsagerRandom.toString()

60
00:00:57,407 --> 00:00:57,409
27. Renseigner les champs de l'accordeon Fondement Legal pour un OQTF 

61
00:00:57,411 --> 00:00:57,414
33. Renseigner les champs de l'accordeon Fondement Legal pour une Remise Schengen 

62
00:00:57,418 --> 00:00:58,164
1. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Etat_Saisi_Remise_Schengen"), "ALLEMAGNE", false, STOP_ON_FAILURE)

