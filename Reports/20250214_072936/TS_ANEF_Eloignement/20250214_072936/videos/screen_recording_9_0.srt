1
00:00:00,003 --> 00:00:00,089
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:00,094 --> 00:00:00,095
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:00,096 --> 00:00:00,098
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:00,099 --> 00:00:00,101
15. DriverName = get("WebUI").get("browserType")

5
00:00:00,103 --> 00:00:00,104
19. println("DriverName :" + DriverName)

6
00:00:00,105 --> 00:00:00,106
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:00,107 --> 00:00:00,108
27. if (Profiles == "Usager")

8
00:00:00,109 --> 00:00:00,109
31. if (Profiles == "Agent")

9
00:00:00,110 --> 00:00:00,111
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:00,112 --> 00:00:06,336
1. openBrowser(URLPortailAgentQualif)

11
00:00:06,338 --> 00:00:06,340
5. if (EnvExec == "URLPortailAgentPreProd")

12
00:00:06,343 --> 00:00:06,425
9. maximizeWindow()

13
00:00:06,428 --> 00:00:06,560
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:06,565 --> 00:00:06,573
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:06,576 --> 00:00:06,577
5. if (Profiles == "Usager")

16
00:00:06,580 --> 00:00:06,581
11. Identification : Portail Agent

17
00:00:06,590 --> 00:00:06,591
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:06,599 --> 00:00:09,130
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

19
00:00:09,132 --> 00:00:11,463
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

20
00:00:11,466 --> 00:00:11,467
5. if (EnvExec == "URLPortailAgentPreProd")

21
00:00:11,469 --> 00:00:12,633
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:12,635 --> 00:00:17,640
15. delay(5)

23
00:00:17,642 --> 00:00:17,682
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:17,684 --> 00:00:17,759
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:17,761 --> 00:00:20,921
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:20,924 --> 00:00:21,009
9. Vérifier la position de la page d'accueil eloignement

27
00:00:21,011 --> 00:00:26,028
13. delay(5)

28
00:00:26,030 --> 00:00:27,181
19. Cliquer sur le bouton Recherche Globale

29
00:00:27,182 --> 00:00:27,183
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:27,185 --> 00:00:27,186
1. NumberUsagerRandom = tools.MyStringTools.getRandomNumber(100000000, 9999999999)

31
00:00:27,188 --> 00:00:27,189
5. println(NumberUsagerRandom)

32
00:00:27,191 --> 00:00:27,192
9. NumberUsager = NumberUsagerRandom.toString()

33
00:00:27,193 --> 00:00:29,481
13. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumberUsager, STOP_ON_FAILURE)

34
00:00:29,483 --> 00:00:30,620
17. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

35
00:00:30,625 --> 00:00:30,660
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

36
00:00:30,661 --> 00:00:31,812
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

37
00:00:31,814 --> 00:00:41,825
29. delay(10)

38
00:00:41,826 --> 00:00:42,015
33. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Aucune_Correspondance"), 5, STOP_ON_FAILURE)

39
00:00:42,016 --> 00:00:43,155
37. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Aucune_Correspondance"), STOP_ON_FAILURE)

40
00:00:43,158 --> 00:00:44,665
41. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Creer_Un_Dossier_Etranger"), STOP_ON_FAILURE)

41
00:00:44,666 --> 00:00:54,670
45. delay(10)

42
00:00:54,672 --> 00:00:54,674
29. if (CreationOuRecherche == "Recherche")

43
00:00:54,676 --> 00:00:54,676
19. if (CreationOuRecherche == "Creation")

44
00:00:54,678 --> 00:00:54,799
3. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

45
00:00:54,801 --> 00:00:54,837
5. Vérification des correspondances entres les accordéons dans la page et le menu à gauche

46
00:00:54,839 --> 00:00:54,861
9. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Numero_Etranger"), 1, STOP_ON_FAILURE)

47
00:00:54,863 --> 00:00:54,880
13. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Prefecture_Gestionnaire"), 1, STOP_ON_FAILURE)

48
00:00:54,882 --> 00:00:54,904
17. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Derniere_Modification"), 1, STOP_ON_FAILURE)

49
00:00:54,906 --> 00:00:54,927
23. Accordeon Reference Dossier

50
00:00:54,931 --> 00:00:54,959
27. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Reference_Du_Dossier"), 1, STOP_ON_FAILURE)

51
00:00:54,961 --> 00:00:54,994
31. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Numero_De_Dossier_FPR"), 1, STOP_ON_FAILURE)

52
00:00:54,996 --> 00:00:55,024
35. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Numero_Dossier_Interne"), 1, STOP_ON_FAILURE)

53
00:00:55,026 --> 00:00:55,046
41. Accordeon Etat Civil 

54
00:00:55,048 --> 00:00:55,070
45. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Fiche_Etat_Civil"), 1, STOP_ON_FAILURE)

55
00:00:55,071 --> 00:00:55,092
51. Accordeon Biometrie 

56
00:00:55,094 --> 00:00:55,118
57. Accordeon Conditions d'entrée en France 

57
00:00:55,120 --> 00:00:55,141
61. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/Acc_ Conditions_D_Entree_En_France"), 1, STOP_ON_FAILURE)

58
00:00:55,142 --> 00:00:55,162
67. Accordeon Antécédents administratifs

59
00:00:55,163 --> 00:00:55,185
73. Accordeon Document De Voyage 

60
00:00:55,186 --> 00:00:55,211
77. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Documents_De_Voyage"), 1, STOP_ON_FAILURE)

61
00:00:55,213 --> 00:00:55,241
83. Accordeon Sortant d'établissement pénitentiaire 

62
00:00:55,243 --> 00:00:55,273
87. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Sortant_D_Etablissement_Penitentiaire"), 1, STOP_ON_FAILURE)

63
00:00:55,274 --> 00:00:55,296
93. Accordeon Consultations sécuritaires

64
00:00:55,298 --> 00:00:55,299
101. Generer un nom aleatoire

65
00:00:55,300 --> 00:00:55,301
105. println(RandomNom)

66
00:00:55,303 --> 00:00:57,572
111. Renseigner Le Nom

67
00:00:57,574 --> 00:00:57,575
117. Renseigner Le Sexe (M/F)

68
00:00:57,577 --> 00:00:58,739
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/btn_radio_Sexe_F"), STOP_ON_FAILURE)

69
00:00:58,741 --> 00:00:58,741
121. if (Sexe == "Homme")

70
00:00:58,743 --> 00:00:59,870
127. Cocher la case date de naissance approximative

71
00:00:59,871 --> 00:01:02,134
133. Renseigner l'Année de Naissance (Majeur/Mineur)

72
00:01:02,136 --> 00:01:02,137
139. Renseigner Le Pays De Naissance  (RPT/RUE) 

73
00:01:02,138 --> 00:01:03,292
1. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Pays_De_Naissance"), "ALGERIE", false, STOP_ON_FAILURE)

74
00:01:03,294 --> 00:01:03,295
143. if (Nationnalite == "RUE")

75
00:01:03,297 --> 00:01:03,297
149. Renseigner la Nationalité 

76
00:01:03,299 --> 00:01:04,457
1. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Nationnalite"), "algérienne", false, STOP_ON_FAILURE)

77
00:01:04,461 --> 00:01:04,462
153. if (Nationnalite == "RUE")

78
00:01:04,465 --> 00:01:04,466
159. Renseigner Le Lieu de Naissance pour (RPT/RUE) 

79
00:01:04,469 --> 00:01:06,759
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Lieu_De_Naissance"), "Wahran", STOP_ON_FAILURE)

80
00:01:06,761 --> 00:01:06,763
163. if (Nationnalite == "RUE")

81
00:01:06,768 --> 00:01:07,952
169. Renseigner la Situation Familiale

82
00:01:07,954 --> 00:01:10,190
175. Renseigner Condition d entrée en France

83
00:01:10,192 --> 00:01:11,334
179. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Condition_Entree_En_France"), "Irrégulière", false, STOP_ON_FAILURE)

84
00:01:11,335 --> 00:01:11,337
183. if (ControleChampsCreation == "true")

85
00:01:11,339 --> 00:01:12,483
189. Validation Creation de dossier

86
00:01:12,485 --> 00:01:12,827
195. Verification de l'affichage et click sur le bouton Valider et attribuer un numero Etranger

87
00:01:12,829 --> 00:01:14,015
199. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/btn_Valider_Attribuer_Numero_Etranger"), STOP_ON_FAILURE)

88
00:01:14,017 --> 00:01:14,020
203. switch (OrigineDossier)

89
00:01:14,023 --> 00:01:14,172
4.  l Origine du Dossier est Interpellation 

90
00:01:14,174 --> 00:01:14,176
8. break

91
00:01:14,178 --> 00:01:14,237
209. Cliquer sur le bouton Attribuer Numero Etranger

92
00:01:14,239 --> 00:01:15,407
215. Cliquer sur le bouton Confirmer et Attribuer Numero Etranger

93
00:01:15,409 --> 00:01:15,493
221. Stocker la valeur Numero Etranger attribué 

94
00:01:15,495 --> 00:01:15,497
225. NumeroEtranger = NumeroEtrangerGenere

95
00:01:15,500 --> 00:01:15,501
229. println(NumeroEtrangerGenere)

96
00:01:15,502 --> 00:01:15,504
233. println(NumeroEtranger)

97
00:01:15,505 --> 00:01:15,506
23. println(NumeroEtranger)

98
00:01:15,507 --> 00:01:15,595
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

99
00:01:15,598 --> 00:01:16,744
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

100
00:01:16,746 --> 00:01:16,747
5. switch (Mesure)

101
00:01:16,749 --> 00:01:41,243
4.  Prendre Une Mesure IAT  

