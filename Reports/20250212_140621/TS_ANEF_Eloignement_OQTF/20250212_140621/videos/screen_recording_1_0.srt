1
00:00:01,496 --> 00:00:03,320
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:03,343 --> 00:00:03,352
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:03,355 --> 00:00:03,360
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:03,362 --> 00:00:03,394
15. DriverName = get("WebUI").get("browserType")

5
00:00:03,397 --> 00:00:03,419
19. println("DriverName :" + DriverName)

6
00:00:03,421 --> 00:00:03,427
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:03,443 --> 00:00:03,448
27. if (Profiles == "Usager")

8
00:00:03,451 --> 00:00:03,454
31. if (Profiles == "Agent")

9
00:00:03,456 --> 00:00:03,460
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:03,462 --> 00:00:03,468
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:03,470 --> 00:00:11,752
1. openBrowser(URLPortailAgentPreProd)

12
00:00:11,756 --> 00:00:11,915
9. maximizeWindow()

13
00:00:11,919 --> 00:00:12,743
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:12,747 --> 00:00:13,202
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:13,206 --> 00:00:13,213
5. if (Profiles == "Usager")

16
00:00:13,221 --> 00:00:13,225
11. Identification : Portail Agent

17
00:00:13,229 --> 00:00:13,234
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:13,238 --> 00:00:13,245
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:13,248 --> 00:00:16,184
1. setText(findTestObject("Object Repository/A_Version_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:16,187 --> 00:00:18,515
5. setText(findTestObject("Object Repository/A_Version_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:18,519 --> 00:00:19,857
9. click(findTestObject("Object Repository/A_Version_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:19,860 --> 00:00:24,913
15. delay(5)

23
00:00:24,917 --> 00:00:25,014
19. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:25,018 --> 00:00:25,657
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:25,661 --> 00:00:28,585
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:28,587 --> 00:00:28,640
9. Vérifier la position de la page d'accueil eloignement

27
00:00:28,644 --> 00:00:33,668
13. delay(5)

28
00:00:33,673 --> 00:00:33,677
19. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

29
00:00:33,681 --> 00:00:34,912
1. click(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Rechercher_Dossier"))

30
00:00:34,915 --> 00:00:35,132
5. NumberUsagerRandom = tools.MyStringTools.getRandomNumber(100000000, 9999999999)

31
00:00:35,136 --> 00:00:35,155
9. println(NumberUsagerRandom)

32
00:00:35,162 --> 00:00:35,178
13. NumberUsager = NumberUsagerRandom.toString()

33
00:00:35,184 --> 00:00:37,634
17. setText(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumberUsager, STOP_ON_FAILURE)

34
00:00:37,636 --> 00:00:38,870
21. click(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

35
00:00:38,874 --> 00:00:38,979
25. scrollToElement(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

36
00:00:38,984 --> 00:00:40,209
29. click(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

37
00:00:40,214 --> 00:00:50,237
33. delay(10)

38
00:00:50,241 --> 00:00:50,312
37. scrollToElement(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Aucune_Correspondance"), 5, STOP_ON_FAILURE)

39
00:00:50,317 --> 00:00:51,515
41. click(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Aucune_Correspondance"), STOP_ON_FAILURE)

40
00:00:51,519 --> 00:00:53,007
45. click(findTestObject("Object Repository/A_Version_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Creer_Un_Dossier_Etranger"), STOP_ON_FAILURE)

41
00:00:53,011 --> 00:01:03,030
49. delay(10)

42
00:01:03,033 --> 00:01:03,038
19. if (CreationOuRecherche == "Creation")

43
00:01:03,044 --> 00:01:04,227
3. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

44
00:01:04,232 --> 00:01:04,278
5. Vérification des correspondances entres les accordéons dans la page et le menu à gauche

45
00:01:04,281 --> 00:01:04,334
9. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Numero_Etranger"), 1, STOP_ON_FAILURE)

46
00:01:04,338 --> 00:01:04,401
13. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Prefecture_Gestionnaire"), 1, STOP_ON_FAILURE)

47
00:01:04,406 --> 00:01:04,450
17. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Derniere_Modification"), 1, STOP_ON_FAILURE)

48
00:01:04,453 --> 00:01:04,500
23. Accordeon Reference Dossier

49
00:01:04,502 --> 00:01:04,551
27. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Reference_Du_Dossier"), 1, STOP_ON_FAILURE)

50
00:01:04,556 --> 00:01:04,607
31. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Numero_De_Dossier_FPR"), 1, STOP_ON_FAILURE)

51
00:01:04,611 --> 00:01:04,657
35. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Numero_Dossier_Interne"), 1, STOP_ON_FAILURE)

52
00:01:04,660 --> 00:01:04,704
41. Accordeon Etat Civil 

53
00:01:04,709 --> 00:01:04,757
45. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Fiche_Etat_Civil"), 1, STOP_ON_FAILURE)

54
00:01:04,761 --> 00:01:04,809
51. Accordeon Biometrie 

55
00:01:04,813 --> 00:01:04,861
57. Accordeon Conditions d'entrée en France 

56
00:01:04,864 --> 00:01:04,911
61. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/Acc_ Conditions_D_Entree_En_France"), 1, STOP_ON_FAILURE)

57
00:01:04,914 --> 00:01:04,960
67. Accordeon Antécédents administratifs

58
00:01:04,965 --> 00:01:05,010
73. Accordeon Document De Voyage 

59
00:01:05,015 --> 00:01:05,073
77. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Documents_De_Voyage"), 1, STOP_ON_FAILURE)

60
00:01:05,077 --> 00:01:05,128
83. Accordeon Sortant d'établissement pénitentiaire 

61
00:01:05,133 --> 00:01:05,180
87. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Sortant_D_Etablissement_Penitentiaire"), 1, STOP_ON_FAILURE)

62
00:01:05,185 --> 00:01:05,238
93. Accordeon Consultations sécuritaires

63
00:01:05,243 --> 00:01:05,363
101. Generer un nom aleatoire

64
00:01:05,367 --> 00:01:05,372
105. println(RandomNom)

65
00:01:05,377 --> 00:01:07,781
111. Renseigner Le Nom

66
00:01:07,785 --> 00:01:07,787
117. Renseigner Le Sexe (M/F)

67
00:01:07,789 --> 00:01:07,791
121. if (Sexe == "Homme")

68
00:01:07,794 --> 00:01:09,021
1. click(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/btn_radio_Sexe_M"), STOP_ON_FAILURE)

69
00:01:09,026 --> 00:01:10,251
127. Cocher la case date de naissance approximative

70
00:01:10,254 --> 00:01:12,553
133. Renseigner l'Année de Naissance (Majeur/Mineur)

71
00:01:12,557 --> 00:01:12,560
139. Renseigner Le Pays De Naissance  (RPT/RUE) 

72
00:01:12,564 --> 00:01:13,816
1. selectOptionByLabel(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Pays_De_Naissance"), "ALGERIE", false, STOP_ON_FAILURE)

73
00:01:13,821 --> 00:01:13,826
143. if (Nationnalite == "RUE")

74
00:01:13,831 --> 00:01:13,833
149. Renseigner la Nationalité 

75
00:01:13,834 --> 00:01:15,031
1. selectOptionByLabel(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Nationnalite"), "algérienne", false, STOP_ON_FAILURE)

76
00:01:15,034 --> 00:01:15,038
153. if (Nationnalite == "RUE")

77
00:01:15,042 --> 00:01:15,044
159. Renseigner Le Lieu de Naissance pour (RPT/RUE) 

78
00:01:15,047 --> 00:01:17,435
1. setText(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Lieu_De_Naissance"), "Wahran", STOP_ON_FAILURE)

79
00:01:17,437 --> 00:01:17,441
163. if (Nationnalite == "RUE")

80
00:01:17,443 --> 00:01:18,627
169. Renseigner la Situation Familiale

81
00:01:18,633 --> 00:01:20,942
175. Renseigner Condition d entrée en France

82
00:01:20,948 --> 00:01:22,144
179. selectOptionByLabel(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Condition_Entree_En_France"), "Irrégulière", false, STOP_ON_FAILURE)

83
00:01:22,148 --> 00:01:22,151
183. if (ControleChampsCreation == "true")

84
00:01:22,156 --> 00:01:23,392
189. Validation Creation de dossier

85
00:01:23,395 --> 00:01:23,740
195. Verification de l'affichage et click sur le bouton Valider et attribuer un numero Etranger

86
00:01:23,744 --> 00:01:24,951
199. click(findTestObject("Object Repository/A_Version_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/btn_Valider_Attribuer_Numero_Etranger"), STOP_ON_FAILURE)

87
00:01:24,956 --> 00:01:24,963
203. switch (OrigineDossier)

88
00:01:24,966 --> 00:01:25,184
4.  l Origine du Dossier est Interpellation 

89
00:01:25,189 --> 00:01:25,197
8. break

90
00:01:25,202 --> 00:01:25,290
209. Cliquer sur le bouton Attribuer Numero Etranger

91
00:01:25,294 --> 00:01:26,554
215. Cliquer sur le bouton Confirmer et Attribuer Numero Etranger

92
00:01:26,559 --> 00:01:26,704
221. Stocker la valeur Numero Etranger attribué 

93
00:01:26,711 --> 00:01:26,715
225. NumeroEtranger = NumeroEtrangerGenere

94
00:01:26,721 --> 00:01:26,724
229. println(NumeroEtrangerGenere)

95
00:01:26,729 --> 00:01:26,745
233. println(NumeroEtranger)

96
00:01:26,750 --> 00:01:26,763
23. println(NumeroEtranger)

97
00:01:26,766 --> 00:01:28,199
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

98
00:01:28,205 --> 00:01:29,465
1. click(findTestObject("Object Repository/A_Version_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

99
00:01:29,470 --> 00:01:29,476
5. switch (Mesure)

100
00:01:29,484 --> 00:01:30,716
4.  Prendre Une Mesure OQTF  

101
00:01:30,721 --> 00:01:31,932
10. Cliquer sur le bourron Confirmer Mesure

102
00:01:31,936 --> 00:01:32,520
14. verifyElementPresent(findTestObject("Object Repository/A_Version_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

103
00:01:32,524 --> 00:01:32,527
18. break

104
00:01:32,532 --> 00:01:34,621
9. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/AVersion_Nawres/ANEF_Prendre_Mesure_Formulaire_1"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

105
00:01:34,627 --> 00:01:34,653
3. Generer la date du jour

106
00:01:34,659 --> 00:01:34,687
7. currentDate = calendar.getTime()

107
00:01:34,693 --> 00:01:34,759
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

108
00:01:34,764 --> 00:01:34,769
15. formattedDate = sdf.format(currentDate)

109
00:01:34,775 --> 00:01:34,778
19. DateActuelle = formattedDate.toString()

110
00:01:34,784 --> 00:01:34,787
23. println(DateActuelle)

111
00:01:34,792 --> 00:01:34,795
27. if (Mesure != "ITF")

112
00:01:34,801 --> 00:01:36,015
3. Remplir le champ Fondement Legal

113
00:01:36,020 --> 00:01:36,025
7. if (Mesure == "Expulsion")

114
00:01:36,030 --> 00:01:36,048
13. Generer un numero aleatoire

115
00:01:36,055 --> 00:01:36,058
17. println(NumberUsagerRandom)

116
00:01:36,063 --> 00:01:36,067
21. RandomNumber = NumberUsagerRandom.toString()

117
00:01:36,071 --> 00:01:36,073
27. Renseigner les champs de l'accordeon Fondement Legal pour un OQTF 

118
00:01:36,076 --> 00:01:36,077
1. if (RefuserDepartVolontaireOQTF == "false")

119
00:01:36,080 --> 00:01:36,085
5. if (RefuserDepartVolontaireOQTF == "true")

120
00:01:36,091 --> 00:01:37,547
3. Refuser le delai depart Volontaire

121
00:01:37,553 --> 00:01:47,570
7. delay(10)

122
00:01:47,574 --> 00:01:47,665
13. Verifier que les champs DDV sont désactivés  

123
00:01:47,670 --> 00:01:47,760
17. verifyElementText(findTestObject("Object Repository/A_Version_Nawres/Page_Prendre_Mesure_Formulaire_1/p_Expiration_Delai"), "-", STOP_ON_FAILURE)

124
00:01:47,764 --> 00:01:49,012
23. renseigner IRTF= 'L. 612-6' 

125
00:01:49,017 --> 00:01:51,394
27. setText(findTestObject("Object Repository/A_Version_Nawres/Page_Prendre_Mesure_Formulaire_1/input_Duree_IRTF_Mois"), "200", STOP_ON_FAILURE)

126
00:01:51,400 --> 00:01:51,460
33. Verifier le message d'ereur de la durée legal IRTF

127
00:01:51,466 --> 00:01:53,780
37. setText(findTestObject("Object Repository/A_Version_Nawres/Page_Prendre_Mesure_Formulaire_1/input_Duree_IRTF_Mois"), RandomNumber, STOP_ON_FAILURE)

128
00:01:53,787 --> 00:01:54,993
41. click(findTestObject("Object Repository/A_Version_Nawres/Page_Prendre_Mesure_Formulaire_1/btn_Enregistrer"), STOP_ON_FAILURE)

129
00:01:54,997 --> 00:01:55,002
33. Renseigner les champs de l'accordeon Fondement Legal pour une Remise Schengen 

130
00:01:55,007 --> 00:01:55,012
39. generer un nombre aleatoire entre '1' et '30'

131
00:01:55,017 --> 00:01:55,019
43. println(RandomNumber)

132
00:01:55,026 --> 00:01:55,029
47. RandomNumberSelect = RandomNumber.toString()

133
00:01:55,035 --> 00:01:55,038
53. Renseigner les champs de l'accordeon Fondement Legal pour un Transfert Dublin 

134
00:01:55,043 --> 00:01:55,046
57. if (Mesure == "ExecutionFicheSIS")

135
00:01:55,051 --> 00:01:55,054
61. if (Mesure == "IAT")

136
00:01:55,059 --> 00:01:55,070
31. if (Mesure == "ITF")

