1
00:00:00,885 --> 00:00:01,904
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:01,920 --> 00:00:01,926
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:01,928 --> 00:00:01,932
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:01,935 --> 00:00:01,959
15. DriverName = get("WebUI").get("browserType")

5
00:00:01,961 --> 00:00:01,976
19. println("DriverName :" + DriverName)

6
00:00:01,979 --> 00:00:01,986
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:01,988 --> 00:00:01,994
27. if (Profiles == "Usager")

8
00:00:01,996 --> 00:00:02,003
31. if (Profiles == "Agent")

9
00:00:02,005 --> 00:00:02,008
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:02,012 --> 00:00:02,015
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:02,017 --> 00:00:07,053
1. openBrowser(URLPortailAgentPreProd)

12
00:00:07,082 --> 00:00:07,881
9. maximizeWindow()

13
00:00:07,884 --> 00:00:08,818
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:08,821 --> 00:00:09,214
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:09,217 --> 00:00:09,222
5. if (Profiles == "Usager")

16
00:00:09,225 --> 00:00:09,231
11. Identification : Portail Agent

17
00:00:09,235 --> 00:00:09,240
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:09,243 --> 00:00:09,252
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:09,256 --> 00:00:12,171
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:12,176 --> 00:00:14,426
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:14,428 --> 00:00:15,626
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:15,629 --> 00:00:20,681
15. delay(5)

23
00:00:20,684 --> 00:00:20,734
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:20,736 --> 00:00:21,149
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:21,152 --> 00:00:23,935
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:23,937 --> 00:00:23,991
9. Vérifier la position de la page d'accueil eloignement

27
00:00:23,994 --> 00:00:29,014
13. delay(5)

28
00:00:29,018 --> 00:00:30,182
19. Cliquer sur le bouton Recherche Globale

29
00:00:30,184 --> 00:00:30,188
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:30,190 --> 00:00:30,193
29. if (CreationOuRecherche == "Recherche")

31
00:00:30,196 --> 00:00:32,459
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:32,461 --> 00:00:33,598
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:33,601 --> 00:00:33,697
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:33,699 --> 00:00:34,831
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:34,838 --> 00:00:39,859
17. delay(5)

36
00:00:39,863 --> 00:00:39,913
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:39,915 --> 00:00:41,054
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:41,058 --> 00:00:42,462
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:42,464 --> 00:00:42,467
19. if (CreationOuRecherche == "Creation")

40
00:00:42,468 --> 00:00:42,473
23. println(NumeroEtranger)

41
00:00:42,475 --> 00:00:43,102
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:43,105 --> 00:00:44,400
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:44,404 --> 00:00:44,409
5. switch (Mesure)

44
00:00:44,412 --> 00:00:44,511
4.  Prendre Une Mesure Expulsion  

45
00:00:44,515 --> 00:00:46,076
8. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/select_Type_Mesure"), "Expulsion", false, STOP_ON_FAILURE)

46
00:00:46,078 --> 00:00:47,242
14. Cliquer sur le bourron Confirmer Mesure

47
00:00:47,244 --> 00:00:47,830
18. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

48
00:00:47,833 --> 00:00:47,836
22. break

49
00:00:47,839 --> 00:00:50,088
9. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

50
00:00:50,099 --> 00:00:50,130
3. Generer la date du jour

51
00:00:50,133 --> 00:00:50,157
7. currentDate = calendar.getTime()

52
00:00:50,160 --> 00:00:50,209
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

53
00:00:50,213 --> 00:00:50,216
15. formattedDate = sdf.format(currentDate)

54
00:00:50,218 --> 00:00:50,223
19. DateActuelle = formattedDate.toString()

55
00:00:50,226 --> 00:00:50,230
23. println(DateActuelle)

56
00:00:50,233 --> 00:00:50,238
27. if (Mesure != "ITF")

57
00:00:50,242 --> 00:00:51,438
3. Remplir le champ Fondement Legal

58
00:00:51,441 --> 00:00:51,443
7. if (Mesure == "Expulsion")

59
00:00:51,444 --> 00:00:51,446
1. if (NatureDeLacteExpulsion == "AME")

60
00:00:51,449 --> 00:00:51,453
5. if (NatureDeLacteExpulsion == "APE")

61
00:00:51,456 --> 00:00:51,461
9. if (UrgenceAbsolueExpulsion == "Non")

62
00:00:51,465 --> 00:00:51,467
13. if (UrgenceAbsolueExpulsion == "Oui")

63
00:00:51,470 --> 00:00:52,632
3. Choisir une Urgence Absolue == Oui 

64
00:00:52,636 --> 00:00:55,553
9. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont activés 

