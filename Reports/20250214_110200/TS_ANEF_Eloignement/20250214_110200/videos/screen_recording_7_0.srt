1
00:00:00,003 --> 00:00:00,097
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:00,101 --> 00:00:00,102
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:00,103 --> 00:00:00,104
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:00,106 --> 00:00:00,107
15. DriverName = get("WebUI").get("browserType")

5
00:00:00,110 --> 00:00:00,111
19. println("DriverName :" + DriverName)

6
00:00:00,113 --> 00:00:00,114
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:00,116 --> 00:00:00,116
27. if (Profiles == "Usager")

8
00:00:00,118 --> 00:00:00,118
31. if (Profiles == "Agent")

9
00:00:00,120 --> 00:00:00,120
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:00,122 --> 00:00:04,684
1. openBrowser(URLPortailAgentQualif)

11
00:00:04,685 --> 00:00:04,687
5. if (EnvExec == "URLPortailAgentPreProd")

12
00:00:04,689 --> 00:00:04,705
9. maximizeWindow()

13
00:00:04,706 --> 00:00:04,804
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:04,806 --> 00:00:04,809
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:04,811 --> 00:00:04,812
5. if (Profiles == "Usager")

16
00:00:04,817 --> 00:00:04,819
11. Identification : Portail Agent

17
00:00:04,827 --> 00:00:04,827
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:04,833 --> 00:00:07,295
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

19
00:00:07,298 --> 00:00:09,604
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

20
00:00:09,605 --> 00:00:09,607
5. if (EnvExec == "URLPortailAgentPreProd")

21
00:00:09,608 --> 00:00:10,738
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:10,741 --> 00:00:15,747
15. delay(5)

23
00:00:15,749 --> 00:00:15,781
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:15,782 --> 00:00:15,867
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:15,869 --> 00:00:18,634
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:18,636 --> 00:00:18,669
9. Vérifier la position de la page d'accueil eloignement

27
00:00:18,671 --> 00:00:23,681
13. delay(5)

28
00:00:23,684 --> 00:00:24,905
19. Cliquer sur le bouton Recherche Globale

29
00:00:24,906 --> 00:00:24,908
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:24,909 --> 00:00:24,922
1. NumberUsagerRandom = tools.MyStringTools.getRandomNumber(100000000, 9999999999)

31
00:00:24,924 --> 00:00:24,925
5. println(NumberUsagerRandom)

32
00:00:24,927 --> 00:00:24,928
9. NumberUsager = NumberUsagerRandom.toString()

33
00:00:24,930 --> 00:00:27,306
13. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumberUsager, STOP_ON_FAILURE)

34
00:00:27,309 --> 00:00:28,488
17. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

35
00:00:28,490 --> 00:00:28,536
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

36
00:00:28,538 --> 00:00:29,674
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

37
00:00:29,676 --> 00:00:39,697
29. delay(10)

38
00:00:39,699 --> 00:00:39,753
33. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Aucune_Correspondance"), 5, STOP_ON_FAILURE)

39
00:00:39,754 --> 00:00:40,947
37. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Aucune_Correspondance"), STOP_ON_FAILURE)

40
00:00:40,949 --> 00:00:42,467
41. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Creer_Un_Dossier_Etranger"), STOP_ON_FAILURE)

41
00:00:42,470 --> 00:00:52,481
45. delay(10)

42
00:00:52,483 --> 00:00:52,487
29. if (CreationOuRecherche == "Recherche")

43
00:00:52,490 --> 00:00:52,491
19. if (CreationOuRecherche == "Creation")

44
00:00:52,493 --> 00:00:52,896
3. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

45
00:00:52,898 --> 00:00:52,940
5. Vérification des correspondances entres les accordéons dans la page et le menu à gauche

46
00:00:52,942 --> 00:00:52,976
9. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Numero_Etranger"), 1, STOP_ON_FAILURE)

47
00:00:52,978 --> 00:00:53,018
13. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Prefecture_Gestionnaire"), 1, STOP_ON_FAILURE)

48
00:00:53,020 --> 00:00:53,053
17. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/lbl_Derniere_Modification"), 1, STOP_ON_FAILURE)

49
00:00:53,055 --> 00:00:53,099
23. Accordeon Reference Dossier

50
00:00:53,101 --> 00:00:53,138
27. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Reference_Du_Dossier"), 1, STOP_ON_FAILURE)

51
00:00:53,140 --> 00:00:53,171
31. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Numero_De_Dossier_FPR"), 1, STOP_ON_FAILURE)

52
00:00:53,174 --> 00:00:53,206
35. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Numero_Dossier_Interne"), 1, STOP_ON_FAILURE)

53
00:00:53,208 --> 00:00:53,247
41. Accordeon Etat Civil 

54
00:00:53,249 --> 00:00:53,285
45. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Fiche_Etat_Civil"), 1, STOP_ON_FAILURE)

55
00:00:53,287 --> 00:00:53,322
51. Accordeon Biometrie 

56
00:00:53,325 --> 00:00:53,369
57. Accordeon Conditions d'entrée en France 

57
00:00:53,372 --> 00:00:53,408
61. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Accordeon/Acc_ Conditions_D_Entree_En_France"), 1, STOP_ON_FAILURE)

58
00:00:53,410 --> 00:00:53,445
67. Accordeon Antécédents administratifs

59
00:00:53,447 --> 00:00:53,494
73. Accordeon Document De Voyage 

60
00:00:53,496 --> 00:00:53,527
77. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Documents_De_Voyage"), 1, STOP_ON_FAILURE)

61
00:00:53,529 --> 00:00:53,558
83. Accordeon Sortant d'établissement pénitentiaire 

62
00:00:53,561 --> 00:00:53,596
87. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Menu/Menu_Sortant_D_Etablissement_Penitentiaire"), 1, STOP_ON_FAILURE)

63
00:00:53,598 --> 00:00:53,628
93. Accordeon Consultations sécuritaires

64
00:00:53,631 --> 00:00:53,688
101. Generer un nom aleatoire

65
00:00:53,691 --> 00:00:53,693
105. println(RandomNom)

66
00:00:53,696 --> 00:00:56,041
111. Renseigner Le Nom

67
00:00:56,044 --> 00:00:56,050
117. Renseigner Le Sexe (M/F)

68
00:00:56,052 --> 00:00:57,233
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/btn_radio_Sexe_F"), STOP_ON_FAILURE)

69
00:00:57,235 --> 00:00:57,237
121. if (Sexe == "Homme")

70
00:00:57,240 --> 00:00:58,407
127. Cocher la case date de naissance approximative

71
00:00:58,412 --> 00:01:00,695
133. Renseigner l'Année de Naissance (Majeur/Mineur)

72
00:01:00,697 --> 00:01:00,698
139. Renseigner Le Pays De Naissance  (RPT/RUE) 

73
00:01:00,700 --> 00:01:01,865
1. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Pays_De_Naissance"), "ALGERIE", false, STOP_ON_FAILURE)

74
00:01:01,867 --> 00:01:01,869
143. if (Nationnalite == "RUE")

75
00:01:01,871 --> 00:01:01,873
149. Renseigner la Nationalité 

76
00:01:01,875 --> 00:01:03,011
1. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Nationnalite"), "algérienne", false, STOP_ON_FAILURE)

77
00:01:03,014 --> 00:01:03,016
153. if (Nationnalite == "RUE")

78
00:01:03,019 --> 00:01:03,020
159. Renseigner Le Lieu de Naissance pour (RPT/RUE) 

79
00:01:03,022 --> 00:01:05,290
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/input_Lieu_De_Naissance"), "Wahran", STOP_ON_FAILURE)

80
00:01:05,294 --> 00:01:05,296
163. if (Nationnalite == "RUE")

81
00:01:05,298 --> 00:01:06,448
169. Renseigner la Situation Familiale

82
00:01:06,452 --> 00:01:08,740
175. Renseigner Condition d entrée en France

83
00:01:08,744 --> 00:01:09,897
179. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Formulaire_Creation_Dossier/Formulaire_Creation_Dossier_Input/select_Condition_Entree_En_France"), "Irrégulière", false, STOP_ON_FAILURE)

84
00:01:09,900 --> 00:01:09,901
183. if (ControleChampsCreation == "true")

85
00:01:09,903 --> 00:03:14,332
189. Validation Creation de dossier

