1
00:00:01,168 --> 00:00:02,382
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:02,397 --> 00:00:02,405
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:02,408 --> 00:00:02,413
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:02,415 --> 00:00:02,440
15. DriverName = get("WebUI").get("browserType")

5
00:00:02,442 --> 00:00:02,458
19. println("DriverName :" + DriverName)

6
00:00:02,460 --> 00:00:02,467
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:02,470 --> 00:00:02,475
27. if (Profiles == "Usager")

8
00:00:02,477 --> 00:00:02,484
31. if (Profiles == "Agent")

9
00:00:02,488 --> 00:00:02,492
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:02,494 --> 00:00:02,500
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:02,505 --> 00:00:08,961
1. openBrowser(URLPortailAgentPreProd)

12
00:00:08,963 --> 00:00:09,184
9. maximizeWindow()

13
00:00:09,186 --> 00:00:10,038
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:10,040 --> 00:00:10,302
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:10,304 --> 00:00:10,309
5. if (Profiles == "Usager")

16
00:00:10,311 --> 00:00:10,315
11. Identification : Portail Agent

17
00:00:10,318 --> 00:00:10,320
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:10,327 --> 00:00:10,333
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:10,335 --> 00:00:12,900
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:12,902 --> 00:00:15,119
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:15,121 --> 00:00:16,295
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:16,296 --> 00:00:21,337
15. delay(5)

23
00:00:21,346 --> 00:00:21,402
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:21,405 --> 00:00:21,767
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:21,769 --> 00:00:24,493
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:24,496 --> 00:00:24,549
9. Vérifier la position de la page d'accueil eloignement

27
00:00:24,551 --> 00:00:29,567
13. delay(5)

28
00:00:29,569 --> 00:00:30,766
19. Cliquer sur le bouton Recherche Globale

29
00:00:30,768 --> 00:00:30,773
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:30,775 --> 00:00:30,778
29. if (CreationOuRecherche == "Recherche")

31
00:00:30,780 --> 00:00:33,095
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:33,098 --> 00:00:34,270
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:34,273 --> 00:00:34,341
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:34,343 --> 00:00:35,508
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:35,512 --> 00:00:40,529
17. delay(5)

36
00:00:40,533 --> 00:00:40,596
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:40,601 --> 00:00:41,768
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:41,773 --> 00:00:43,238
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:43,241 --> 00:00:43,246
19. if (CreationOuRecherche == "Creation")

40
00:00:43,248 --> 00:00:43,253
23. println(NumeroEtranger)

41
00:00:43,256 --> 00:00:44,241
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:44,247 --> 00:00:46,140
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:46,143 --> 00:00:46,151
5. switch (Mesure)

44
00:00:46,154 --> 00:00:46,230
4.  Prendre Une Mesure Expulsion  

45
00:00:46,233 --> 00:00:47,471
8. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/select_Type_Mesure"), "Expulsion", false, STOP_ON_FAILURE)

46
00:00:47,476 --> 00:00:48,638
14. Cliquer sur le bourron Confirmer Mesure

47
00:00:48,640 --> 00:00:49,431
18. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

48
00:00:49,436 --> 00:00:49,441
22. break

49
00:00:49,444 --> 00:00:51,340
9. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

50
00:00:51,343 --> 00:00:51,363
3. Generer la date du jour

51
00:00:51,365 --> 00:00:51,386
7. currentDate = calendar.getTime()

52
00:00:51,388 --> 00:00:51,443
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

53
00:00:51,447 --> 00:00:51,451
15. formattedDate = sdf.format(currentDate)

54
00:00:51,456 --> 00:00:51,462
19. DateActuelle = formattedDate.toString()

55
00:00:51,467 --> 00:00:51,471
23. println(DateActuelle)

56
00:00:51,474 --> 00:00:51,477
27. if (Mesure != "ITF")

57
00:00:51,480 --> 00:00:52,826
3. Remplir le champ Fondement Legal

58
00:00:52,828 --> 00:00:52,833
7. if (Mesure == "Expulsion")

59
00:00:52,836 --> 00:00:52,842
1. if (NatureDeLacteExpulsion == "AME")

60
00:00:52,846 --> 00:00:54,049
3. Choisir une Nature de l'Acte AME 

61
00:00:54,054 --> 00:00:54,147
9. Vérifier l'autorité Decisionnaire : Ministre de l’Intérieur 

62
00:00:54,151 --> 00:00:54,233
13. verifyElementText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/p_Autorité_Decisionnaire"), "Ministre de l’Intérieur", STOP_ON_FAILURE)

63
00:00:54,236 --> 00:00:54,243
5. if (NatureDeLacteExpulsion == "APE")

64
00:00:54,248 --> 00:00:54,252
9. if (UrgenceAbsolueExpulsion == "Non")

65
00:00:54,255 --> 00:00:55,460
3. Choisir une Urgence Absolue == Non 

66
00:00:55,465 --> 00:00:58,264
9. Renseigner les champs Obligatoire Comex

67
00:00:58,268 --> 00:01:00,547
13. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/input_Date_Comex"), "22/06/2024", STOP_ON_FAILURE)

68
00:01:00,549 --> 00:01:01,732
17. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/btn_radio_Avis_Comex_Favorable"), STOP_ON_FAILURE)

69
00:01:01,736 --> 00:01:04,035
21. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/input_Date_Avis_Comex"), "22/06/2024", STOP_ON_FAILURE)

70
00:01:04,038 --> 00:01:05,214
27. Refuser de Poursuivre la procédure d'expulsion

71
00:01:05,218 --> 00:01:10,236
31. delay(5)

72
00:01:10,240 --> 00:01:10,302
37. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont desactivés 

73
00:01:10,306 --> 00:01:15,318
41. delay(5)

74
00:01:15,323 --> 00:01:15,391
45. verifyElementNotClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Auteur_Decision"))

75
00:01:15,394 --> 00:01:15,445
49. verifyElementNotClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Ajouter_Mesure_Execution"))

76
00:01:15,448 --> 00:01:16,649
55. Accepter de Poursuivre la procédure d'expulsion

77
00:01:16,652 --> 00:01:16,718
61. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont activés 

78
00:01:16,723 --> 00:01:20,203
65. waitForElementClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Pays_De_Renvoi"), 10)

