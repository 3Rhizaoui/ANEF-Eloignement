1
00:00:00,941 --> 00:00:02,479
3. Appel Brique Réutilisable pour lancer URl ANEF pour Agent

2
00:00:02,500 --> 00:00:02,507
5. RunConfiguration: getProjectDir for LogDriver 

3
00:00:02,509 --> 00:00:02,516
11. RunConfiguration: getExecutionProperties Driver 

4
00:00:02,518 --> 00:00:02,550
15. DriverName = get("WebUI").get("browserType")

5
00:00:02,552 --> 00:00:02,572
19. println("DriverName :" + DriverName)

6
00:00:02,574 --> 00:00:02,586
23. println("Driverpath :" + RunBrowserConfiguration.get("drivers"))

7
00:00:02,589 --> 00:00:02,596
27. if (Profiles == "Usager")

8
00:00:02,599 --> 00:00:02,606
31. if (Profiles == "Agent")

9
00:00:02,608 --> 00:00:02,616
1. if (EnvExec == "URLPortailAgentQualif")

10
00:00:02,618 --> 00:00:02,623
5. if (EnvExec == "URLPortailAgentPreProd")

11
00:00:02,625 --> 00:00:09,405
1. openBrowser(URLPortailAgentPreProd)

12
00:00:09,408 --> 00:00:09,566
9. maximizeWindow()

13
00:00:09,569 --> 00:00:10,510
9. Appel Brique Réutilisable pour Identification Agent

14
00:00:10,513 --> 00:00:10,810
1. com.kazurayam.ksbackyard.HighlightElement.pandemic()

15
00:00:10,813 --> 00:00:10,817
5. if (Profiles == "Usager")

16
00:00:10,820 --> 00:00:10,823
11. Identification : Portail Agent

17
00:00:10,825 --> 00:00:10,829
1. if (EnvExec == "URLPortailAgentQualif")

18
00:00:10,832 --> 00:00:10,835
5. if (EnvExec == "URLPortailAgentPreProd")

19
00:00:10,837 --> 00:00:13,458
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_UserNameAgent"), IdentifiantAgent)

20
00:00:13,459 --> 00:00:15,678
5. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/Input_PasswordAgent"), PwAgent)

21
00:00:15,680 --> 00:00:16,881
9. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_ANEF_Connexion/btn_Valider_Conx_Agent"))

22
00:00:16,883 --> 00:00:21,925
15. delay(5)

23
00:00:21,927 --> 00:00:22,003
19. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Accueil_Principale/btn_ANEF_Eloignement"), 1, STOP_ON_FAILURE)

24
00:00:22,006 --> 00:00:22,510
15. Appel Brique Réutilisable pour Creation ou Recherche de dossier avec un numero etranger 

25
00:00:22,512 --> 00:00:25,834
3. Accèder à la page d'accueil  ANEF eloignement

26
00:00:25,838 --> 00:00:25,885
9. Vérifier la position de la page d'accueil eloignement

27
00:00:25,889 --> 00:00:30,911
13. delay(5)

28
00:00:30,913 --> 00:00:32,091
19. Cliquer sur le bouton Recherche Globale

29
00:00:32,093 --> 00:00:32,097
25. Choisir la methode de Creation d'un nouveau dossier pour un numero etranger inexistant

30
00:00:32,099 --> 00:00:32,103
29. if (CreationOuRecherche == "Recherche")

31
00:00:32,104 --> 00:00:34,438
1. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), NumeroEtranger, STOP_ON_FAILURE)

32
00:00:34,441 --> 00:00:35,632
5. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/Input_Numero_etranger"), STOP_ON_FAILURE)

33
00:00:35,636 --> 00:00:35,721
9. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), 5, STOP_ON_FAILURE)

34
00:00:35,723 --> 00:00:36,920
13. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Lancer_La_Recherche"), STOP_ON_FAILURE)

35
00:00:36,921 --> 00:00:41,941
17. delay(5)

36
00:00:41,944 --> 00:00:41,999
21. scrollToElement(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), 5, STOP_ON_FAILURE)

37
00:00:42,002 --> 00:00:43,141
25. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Radio_Selectionner_Dossier"), STOP_ON_FAILURE)

38
00:00:43,145 --> 00:00:44,540
29. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Creation_ou_Recherche_Dossier/btn_Choisir_Dossier_Etranger"), STOP_ON_FAILURE)

39
00:00:44,542 --> 00:00:44,548
19. if (CreationOuRecherche == "Creation")

40
00:00:44,549 --> 00:00:44,553
23. println(NumeroEtranger)

41
00:00:44,556 --> 00:00:45,204
29. Appel Brique Réutilisable pour Prendre une Mesure selon les Choix : OQTF , Expulsion ,IAT ,ITF ,ExecutionFicheSIS, RemiseSchengen, TransfertDublin

42
00:00:45,207 --> 00:00:46,519
1. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Prendre_Mesure"), STOP_ON_FAILURE)

43
00:00:46,522 --> 00:00:46,528
5. switch (Mesure)

44
00:00:46,531 --> 00:00:46,944
4.  Prendre Une Mesure Expulsion  

45
00:00:46,946 --> 00:00:48,178
8. selectOptionByLabel(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/select_Type_Mesure"), "Expulsion", false, STOP_ON_FAILURE)

46
00:00:48,183 --> 00:00:49,328
14. Cliquer sur le bourron Confirmer Mesure

47
00:00:49,330 --> 00:00:50,008
18. verifyElementPresent(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Supprimer_Fiche_Mesure"), 2, STOP_ON_FAILURE)

48
00:00:50,010 --> 00:00:50,013
22. break

49
00:00:50,015 --> 00:00:51,751
9. callTestCase(findTestCase("Test Cases/Test Reutilisable/Main/ANEF_Eloignement_V_Nawres/ANEF_Prendre_Mesure_Formulaire"), ["Mesure":Mesure, "FondementLegal":FondementLegal, "NatureDeLacteExpulsion":NatureDeLacteExpulsion, "UrgenceAbsolueExpulsion":UrgenceAbsolueExpulsion, ... ], STOP_ON_FAILURE)

50
00:00:51,754 --> 00:00:51,774
3. Generer la date du jour

51
00:00:51,776 --> 00:00:51,794
7. currentDate = calendar.getTime()

52
00:00:51,797 --> 00:00:51,846
11. sdf = new java.text.SimpleDateFormat(dd/MM/yyyy)

53
00:00:51,849 --> 00:00:51,851
15. formattedDate = sdf.format(currentDate)

54
00:00:51,854 --> 00:00:51,858
19. DateActuelle = formattedDate.toString()

55
00:00:51,863 --> 00:00:51,867
23. println(DateActuelle)

56
00:00:51,870 --> 00:00:51,875
27. if (Mesure != "ITF")

57
00:00:51,880 --> 00:00:53,048
3. Remplir le champ Fondement Legal

58
00:00:53,051 --> 00:00:53,054
7. if (Mesure == "Expulsion")

59
00:00:53,057 --> 00:00:53,062
1. if (NatureDeLacteExpulsion == "AME")

60
00:00:53,067 --> 00:00:54,225
3. Choisir une Nature de l'Acte AME 

61
00:00:54,227 --> 00:00:54,311
9. Vérifier l'autorité Decisionnaire : Ministre de l’Intérieur 

62
00:00:54,313 --> 00:00:54,393
13. verifyElementText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/p_Autorité_Decisionnaire"), "Ministre de l’Intérieur", STOP_ON_FAILURE)

63
00:00:54,397 --> 00:00:54,400
5. if (NatureDeLacteExpulsion == "APE")

64
00:00:54,403 --> 00:00:54,408
9. if (UrgenceAbsolueExpulsion == "Non")

65
00:00:54,413 --> 00:00:55,570
3. Choisir une Urgence Absolue == Non 

66
00:00:55,572 --> 00:00:58,392
9. Renseigner les champs Obligatoire Comex

67
00:00:58,394 --> 00:01:00,620
13. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/input_Date_Comex"), "22/06/2024", STOP_ON_FAILURE)

68
00:01:00,622 --> 00:01:01,762
17. click(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/btn_radio_Avis_Comex_Favorable"), STOP_ON_FAILURE)

69
00:01:01,764 --> 00:01:03,996
21. setText(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/input_Date_Avis_Comex"), "22/06/2024", STOP_ON_FAILURE)

70
00:01:03,998 --> 00:01:05,132
27. Refuser de Poursuivre la procédure d'expulsion

71
00:01:05,134 --> 00:01:05,187
33. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont desactivés 

72
00:01:05,189 --> 00:01:10,195
37. delay(5)

73
00:01:10,198 --> 00:01:10,246
41. verifyElementNotClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Auteur_Decision"))

74
00:01:10,249 --> 00:01:10,289
45. verifyElementNotClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure/btn_Ajouter_Mesure_Execution"))

75
00:01:10,291 --> 00:01:11,431
51. Accepter de Poursuivre la procédure d'expulsion

76
00:01:11,434 --> 00:01:11,475
57. Vérifier que les champs de l'accordeon : Décision fixant le pays de renvoi sont activés 

77
00:01:11,479 --> 00:01:13,783
61. waitForElementClickable(findTestObject("Object Repository/ANEF_Eloignement_V_Nawres/Page_Prendre_Mesure_Formulaire/select_Pays_De_Renvoi"), 10)

